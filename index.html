D'accord, je vais simplifier le code en utilisant une autre bibliothèque pour effectuer la requête vers l'API Google Sheets. Nous allons utiliser la bibliothèque `axios` pour effectuer une requête HTTP POST vers l'API Google Sheets.

Assurez-vous d'ajouter la bibliothèque `axios` à votre projet en incluant la balise script suivante dans votre en-tête HTML ou en installant la bibliothèque via npm ou yarn.

```html
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
```

Voici une version modifiée du code pour écrire dans la feuille "enregistrement" de votre spreadsheet. Remplacez également 'VOTRE_CLÉ_API' par votre clé API.

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Emargement JPO</title>
</head>

<body class="cont">
    <h3 class="txt-cntr mar-top-2">JPO du 09/12/23</h3>

    <article class="pad-2">
        <section>
            <div class="frm-grp txt-cntr">
                <label class="disp-blck">Choisissez la caméra :</label>
                <select id="webcameraChanger" onchange="cameraChange($(this).val());" class="frm-ctrl mar-btm-2"></select>
            </div>
            <!-- Composant de vue de la caméra Web -->
            <video id="webcameraPreview" playsinline autoplay controls muted loop style="width: 100%;"></video>
        </section>
    </article>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="../../external/adapter.min.js"></script>
    <script type="text/javascript" src="../../external/instascan.js"></script>
    <script type="text/javascript" src="../../src/QrCodeScanner.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script type="text/javascript">
        var videoComponent = $("#webcameraPreview");
        var webcameraChanger = $("#webcameraChanger");
        var options = {};
        var cameraId = 0;

        // Initialise les options pour le scanner
        options = initVideoObjectOptions("webcameraPreview");

        // Initialise le scanner
        initScanner(options);

        // Initialise les caméras disponibles
        initAvaliableCameras(
            webcameraChanger,
            function () {
                cameraId = parseInt(getSelectedCamera(webcameraChanger));
            }
        );

        // Initialise la caméra sélectionnée
        initCamera(cameraId);

        function appendDataToSheet(email) {
            // ID de votre feuille de calcul
            var spreadsheetId = '1gvvhXBmO_0rPJvCNYiO9yXBgd2PRjNTw1PKlwE-3dqQ';
            // URL de l'API Google Sheets
            var sheetsAPIUrl = 'https://sheets.googleapis.com/v4/spreadsheets/' + spreadsheetId + '/values/scan:append';

            // Clé API
            var apiKey = 'AIzaSyDuSVZIxItzg1u85BS2LPyFo9ovSXQ54pw';

            // Données à ajouter
            var values = [
                [email]
            ];

            // Corps de la requête
            var requestBody = {
                values: values
            };

            // Paramètres de la requête
            var params = {
                key: apiKey,
                valueInputOption: 'RAW'
            };

            // Effectuer la requête POST avec axios
            axios.post(sheetsAPIUrl, requestBody, { params: params })
                .then(function (response) {
                    console.log('Données ajoutées avec succès :', response.data);
                })
                .catch(function (error) {
                    console.error('Erreur lors de l\'ajout des données :', error.response.data.error.message);
                });
        }

        // Démarre la numérisation
        scanStart(function (data) {
            // Supposons que les données scannées soient une adresse e-mail
            appendDataToSheet(data);
        });
    </script>
</body>
</html>
```

Cette version utilise la bibliothèque axios pour effectuer une requête HTTP POST vers l'API Google Sheets. Assurez-vous de remplacer 'VOTRE_CLÉ_API' par votre clé API. Si vous rencontrez des problèmes, consultez la console du navigateur pour voir les messages d'erreur.
